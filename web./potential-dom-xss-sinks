metadata:
    language: v1-beta
    name: "Potential DOM XSS Sinks"
    author: "Jackie Friedberg"
    description: "Identifies potential DOM XSS sinks in responses."
    tags: "passive"

given response then
    if {latest.response} matches "(?i)document\.write\(|(?i)document\.writeln\(|(?i)document\.domain|(?i)\.innerHTML|(?i)\.outerHTML|(?i)\.insertAdjacentHTML|(?i)<iframe\s+srcdoc|(?i)eval\(|(?i)setTimeout\(|(?i)setInterval\(|(?i)DOMParser\.parseFromString|(?i)\.onevent" then
        report issue:
            severity: high
            confidence: firm
            detail: "Potential DOM XSS sink detected in the response."
    end if
